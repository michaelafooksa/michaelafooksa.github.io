<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/css/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ENjdO4Dr2bkBIFxQpeoTz1HIcje39Wm4jDKdf19U8gI4ddQ3GYNS7NTKfAdVQSZe" crossorigin="anonymous"></script>
  <link href="style.css" rel="stylesheet">
  <title>Tech test</title>
  <script async type="text/javascript" src="https://static.klaviyo.com/onsite/js/klaviyo.js?company_id=Y8LNjW"></script>
  <!-- <script>!function(){if(!window.klaviyo){window._klOnsite=window._klOnsite||[];try{window.klaviyo=new Proxy({},{get:function(n,i){return"push"===i?function(){var n;(n=window._klOnsite).push.apply(n,arguments)}:function(){for(var n=arguments.length,o=new Array(n),w=0;w<n;w++)o[w]=arguments[w];var t="function"==typeof o[o.length-1]?o.pop():void 0,e=new Promise((function(n){window._klOnsite.push([i].concat(o,[function(i){t&&t(i),n(i)}]))}));return e}}})}catch(n){window.klaviyo=window.klaviyo||[],window.klaviyo.push=function(){var n;(n=window._klOnsite).push.apply(n,arguments)}}}}();</script> -->
</head>
<body>
  <div class="container">
  <h1 class="mt-3">Add values to a List type profile property</h1>
<!--   <script type="text/javascript">
    document.getElementById("clickme").addEventListener('click',function (){
        klaviyo.push(['track', 'Clicked Button']);
    });
  </script> -->
  
  <form id="klaviyo-custom-form">
        <!-- <label for="fname">First Name:</label><br />
        <input type="text" id="fname" name="fname"><br />

        <label for="lname">Last Name:</label><br />
        <input type="text" id="lname" name="lname"> <br /> -->

        <label for="email_address">Email:</label>
        <input type="text" id="email_address" name="email_address" class="mb-2"></br>

        <label for="property_name">Property Name to Update:</label>
        <input type="text" id="property_name" name="property_name" class="mb-2"></br>

        <label for="property_value">Property Value to add/remove:</label>
        <input type="text" id="property_value" name="property_value" class="mb-2"></br>

        <label for="add">Would you like to add or remove this property?</label></br>
        <input type="radio" id="html" name="add" value="add">
        <label for="html">Add</label><br>
        <input type="radio" id="css" name="add" value="remove">
        <label for="css">Remove</label><br>

    
    <input type="submit" id="submit_button" class="btn btn-secondary"></input>
    </form>
  
  <script type="text/javascript">
    const form = document.getElementById("klaviyo-custom-form");
    form.addEventListener("submit", (event) => {
      event.preventDefault();
    
        // let firstName = form.fname.value;
        // let lastName = form.lname.value;
        let email = form.email_address.value;
        let propertyName = form.property_name.value;
        let propertyValue = form.property_value.value;
        let add = form.add.value;
    
        const options = {
          method: 'POST',
          headers: { 'Content-Type': 'application/json', 'Accept':'application/json' },
          referrerPolicy:"no-referrer",
          body: JSON.stringify({
            "property":propertyName,
            "value":propertyValue,
            "email_address":email,
            "add":add
          })
        };

        fetch(`https://michaela-fooksa.npkn.net/update-list-from-site/`, options)
          .then((response) => response.json())
            // .then((response) => { 
            //   console.log(response.body); 
            // })
            .then((data) => {
                console.log("data");
                console.log(data);
              })
              .catch(err => {
                console.log("error!");
                console.error(err);
              });
          // const result = response.json();
        //   console.log("success: ", response);
        // }
        // catch (error) {
        //   console.log("Error:",error);
        // }
    })
    button=document.getElementById("submit_button");
    button.addEventListener("click",(event)=>{button.value="Thanks for submitting!"});
    </script>
  </div>
</body>
</html>
